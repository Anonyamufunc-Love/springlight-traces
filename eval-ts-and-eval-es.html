<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-eval-ts-and-eval-es" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">EvalTS 与 EvalES | 春日影踪</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://anonyamufunc-love.github.io/springlight-traces/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://anonyamufunc-love.github.io/springlight-traces/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://anonyamufunc-love.github.io/springlight-traces/eval-ts-and-eval-es"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="EvalTS 与 EvalES | 春日影踪"><meta data-rh="true" name="description" content="本章将深入探讨 bolt-cep 中的两大核心 API：EvalTS 与 EvalES。"><meta data-rh="true" property="og:description" content="本章将深入探讨 bolt-cep 中的两大核心 API：EvalTS 与 EvalES。"><link data-rh="true" rel="icon" href="/springlight-traces/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://anonyamufunc-love.github.io/springlight-traces/eval-ts-and-eval-es"><link data-rh="true" rel="alternate" href="https://anonyamufunc-love.github.io/springlight-traces/eval-ts-and-eval-es" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://anonyamufunc-love.github.io/springlight-traces/eval-ts-and-eval-es" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/springlight-traces/assets/css/styles.fc374fa2.css">
<script src="/springlight-traces/assets/js/runtime~main.8979cb94.js" defer="defer"></script>
<script src="/springlight-traces/assets/js/main.626f80bc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/springlight-traces/"><b class="navbar__title text--truncate">春日影踪</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/springlight-traces/">春日影踪 - bolt-cep</a><a href="https://github.com/Anonyamufunc-Love/springlight-traces" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/springlight-traces/">春日影踪</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/preparations">准备工作</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/install-bolt-cep">安装 bolt-cep</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/build-bolt-cep">编译 bolt-cep</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/getting-started-with-project-files">熟悉 bolt-cep 项目结构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/springlight-traces/eval-ts-and-eval-es">EvalTS 与 EvalES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/listen-ts-and-dispatch-ts">ListenTS 和 DispatchTS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/build-typescript-docs-tutorial">自构建 TypeScript API 文档</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/getting-started-panel-frontend">渐入面板前端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/use-component-library">安装并使用组件库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/data-stroage">数据存储</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-backend">扩展后端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/use-web-assembly">使用 WebAssembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/custom-compilation">定制化编译行为</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/publishing-extension">分发扩展</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/use-jest-unit-test">使用 Jest 进行单元测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/use-eslint">使用 ESLint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/add-host-3rd-library">给 Host 端添加第三方库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/ext_join-bolt-cep-community">加入 bolt-cep 社区</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/springlight-traces/extend-script/getting-started-with-extendscript">就算迷茫也要写下去！—— 入门ExtendScript</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/vscode-plugin-extendscript-debugger">ExtendScript 调试器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/writeln">日志 —— $.writeln</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/app-project">项目 —— app.project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/comp-item">合成 —— CompItem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/layer">图层 —— Layer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/property">属性 —— Property</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/av-layer">音视觉图层 —— AVLayer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/camera-layer">摄像机图层 —— CameraLayer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/light-layer">灯光图层 —— LightLayer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/footage-item">素材 —— FootageItem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/springlight-traces/extend-script/file">文件 —— File</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/springlight-traces/ext_bolt-cep-donts">别再“無路矢”！—— 部分编码约定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/springlight-traces/ext_sources">参考文献</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/springlight-traces/api">接口文档</a><button aria-label="展开侧边栏分类 &#x27;接口文档&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/springlight-traces/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/springlight-traces/"><span itemprop="name">春日影踪</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">EvalTS 与 EvalES</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>EvalTS 与 EvalES</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>本章将深入探讨 bolt-cep 中的两大核心 API：<code>EvalTS</code> 与 <code>EvalES</code>。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evalts-与-evales-是什么">EvalTS 与 EvalES 是什么？<a href="#evalts-与-evales-是什么" class="hash-link" aria-label="EvalTS 与 EvalES 是什么？的直接链接" title="EvalTS 与 EvalES 是什么？的直接链接">​</a></h2>
<p>在深入了解这两个 API 之前，我们先看一下标准 CEP (Common Extensibility Platform) 的技术架构。</p>
<div align="center"><p><img decoding="async" loading="lazy" alt="CEP 技术概览" src="data:image/png;base64,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" width="530" height="235" class="img_ev3q"></p></div>
<center>图片来源: <a href="http://blog.nullice.com/%E6%8A%80%E6%9C%AF/CEP-%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/%E6%8A%80%E6%9C%AF-CEP-%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B-Adobe-CEP-%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B-%E3%80%8C-2-%E3%80%8DCEP-%E6%8A%80%E6%9C%AF%E6%A6%82%E8%A7%88/" target="_blank" rel="noopener noreferrer">Adobe CEP 扩展开发教程 「 2 」CEP 技术概览</a></center>
<br>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>此处的 <code>jsx</code> 并不是 React 的那个 <code>jsx</code>，而是 Adobe ExtendScript 的文件扩展名。</p></div></div>
<p>宿主端 (Host)：
通过 ExtendScript 直接访问和控制 Adobe 应用程序的核心功能，如 After Effects 中的图层和合成。</p>
<p>CEP 端 (Extension)：
负责扩展的用户界面和交互（使用 Web 技术）。它通过 <code>evalScript</code> 执行宿主层脚本，并能使用 <code>addEventListener</code> 监听来自宿主层的事件。</p>
<br>
<p>在 <code>bolt-cep</code> 框架中，上图所展示的 CEP 技术概览依然适用。然而，<code>bolt-cep</code> 在此基础上进行了诸多优化与封装：</p>
<ol>
<li><code>CSInterface</code> 的封装：<code>bolt-cep</code> 将原生的 <code>CSInterface</code> 封装为 <code>csInterface.ts</code>，并基于此构建了多种便捷的工具类。<code>EvalTS</code> 和 <code>EvalES</code> 正是这些工具类的重要组成部分，它们位于 <code>js/lib/utils/bolt.ts</code> 文件中。</li>
<li>前端视图的现代化：传统的 HTML 解析器和渲染部分，在 <code>bolt-cep</code> 项目中由现代前端框架（如 React、Vue 等）接管，提升了开发效率和用户体验。</li>
<li>宿主脚本的编写方式革新：得益于 <code>bolt-cep</code> 的高度封装，开发者不再局限于使用传统的 ExtendScript (.jsx) 文件来编写宿主环境（Host端）的逻辑。现在，你可以直接在 <code>src/jsx</code> 目录下使用 TypeScript 编写代码，甚至可以运用部分 ES6 语法（尽管为了确保最佳兼容性和稳定性，建议贴近 ES3 的规范编写，更多请查阅 <a href="/springlight-traces/ext_bolt-cep-donts">别再“無路矢”！—— 部分编码约定</a>，其中有一些建议，例如 “谨慎使用展开语法”）。<code>bolt-cep</code> 会负责将这些 TypeScript 代码编译成宿主应用程序兼容的 ExtendScript。</li>
</ol>
<p>那么，关键问题来了：在 CEP 环境中，我们如何调用这些运行在宿主应用程序（如 Photoshop, After Effects）环境内的 TypeScript/ExtendScript 函数呢？</p>
<p><code>EvalTS</code> 和 <code>EvalES</code> 正是为解决这一跨环境通信问题而设计的。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evalts">EvalTS<a href="#evalts" class="hash-link" aria-label="EvalTS的直接链接" title="EvalTS的直接链接">​</a></h2>
<p><code>EvalTS</code> 是 <code>bolt-cep</code> 提供的 <code>bolt.ts</code> 文件中的一个核心方法。它允许开发者在 CEP 端以类型安全的方式调用定义在 Host 端（宿主应用程序环境）的 TypeScript 函数。</p>
<p>让我们看一下 <code>EvalTS</code> 的方法签名：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> evalTS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Key </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name builtin">string</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">keyof</span><span class="token plain"> Scripts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Func </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name builtin">Function</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> Scripts</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  functionName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">args</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ArgTypes</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Func</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ReturnType</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Func</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>EvalTS</code> 接收两个主要参数：</p>
<ul>
<li><code>functionName</code> (<code>Key</code>): 一个字符串，表示需要调用的 Host 端函数的名称。此名称必须是 <code>Scripts</code> 接口中定义的键，并且对应的值必须是一个函数类型。</li>
<li><code>args</code> (<code>...ArgTypes&lt;Func&gt;</code>): 一个或多个参数，将按顺序传递给目标 Host 端函数。</li>
</ul>
<p><code>EvalTS</code> 的返回值是一个 <code>Promise</code> 对象。当 Host 端函数执行完毕后，该 Promise 会 resolve 并返回函数的执行结果；如果执行出错，则会 reject。</p>
<p>接下来，我们深入了解 <code>Scripts</code> 接口。该接口通常定义在 <code>src/jsx/index.ts</code> 文件中：</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>以下展示的是 Demo 项目中的 <code>Scripts</code> 接口定义。对于通过 Skeleton 模板创建的项目，此接口的内容会根据你在项目创建时所选择的 Adobe 应用程序而有所不同，不会默认包含所有模块。</p><p>从 2.0.0 版本开始，Demo 和 Skeleton 模板被移除，你现在需要指定 Adobe 应用，<code>bolt-cep</code> 会为你生成对应的 <code>Scripts</code> 接口。</p></div></div>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/jsx/index.ts</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Scripts</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> aeft </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> ame </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> anim </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> audt </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> idsn </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> ilst </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> kbrg </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> phxs </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> ppro</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>Scripts</code> 接口是一个类型别名，它聚合了多个模块（如 <code>aeft</code>、<code>ame</code> 等）导出的所有可调用函数。例如，<code>aeft</code> 模块的导入方式如下：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/jsx/index.ts</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> aeft </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./aeft/aeft&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我们再追踪到 <code>aeft</code> 模块的具体实现，例如 <code>src/jsx/aeft/aeft.ts</code>：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/jsx/aeft/aeft.ts</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  helloVoid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  helloError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  helloStr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  helloNum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  helloArrayStr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  helloObj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../utils/samples&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> helloError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> helloStr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> helloNum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> helloArrayStr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> helloObj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> helloVoid </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> dispatchTS </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../utils/utils&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">helloWorld</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello from After Effects!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">project</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">activeItem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>为了让 <code>EvalTS</code> 能够识别并调用我们在 Host 端定义的函数，有以下几种推荐的导出方式：</p>
<ol>
<li>
<p><strong>直接 <code>export</code> 导出函数（推荐）</strong>：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 在例如 aeft.ts 或其他模块文件中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> myTestFunction </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../springlightTraces&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 假设函数在别处定义</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> myTestFunction </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 也可以使用别名导出</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> myTestFunction </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> myTestFunctionAeft </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>直接在模块文件（如 <code>aeft.ts</code>）中定义并导出</strong>：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 在例如 aeft.ts 文件中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">myTestFunction</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 函数具体实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>重定向导出</strong>：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 在例如 aeft.ts 文件中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> myTestFunction </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../springlightTraces&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> myTestFunctionAeft </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> myTestFunction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 将导入的函数以新名称导出</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>完成函数定义和导出后，我们可以验证 <code>EvalTS</code> 是否能正确识别。在 CEP 端的代码中，当输入 <code>evalTS(&quot;</code> 时，Visual Studio Code 等支持 TypeScript 的编辑器通常会提供自动补全提示，列出所有可用的函数名：</p>
<div align="center"><p><img decoding="async" loading="lazy" src="/springlight-traces/assets/images/QQ_1748239628671-02dc8fceb4d265753f3f263f813604ee.png" width="670" height="347" class="img_ev3q"></p></div>
<p>如上图所示，<code>functionName</code> 的提示中已包含了我们定义的函数。</p>
<p>现在，我们可以实际调用 <code>EvalTS</code>。例如，Host 端有一个如下函数：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Host 端 (src/jsx/aeft/aeft.ts)</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">helloArrayStr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arr</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">ExtendScript received an array of </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">arr</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">length</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c"> strings: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">arr</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation function" style="color:#d73a49">toString</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> arr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在 CEP 端调用它：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">CEP 端 (src/js/main/main.vue)</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">evalTS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;helloArrayStr&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;kira&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kira&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;doki&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;doki&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// [&quot;kira&quot;, &quot;kira&quot;, &quot;doki&quot;, &quot;doki&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error calling helloArrayStr:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>请注意，由于 <code>EvalTS</code> 返回的是 Promise，我们需要使用 <code>.then()</code> 来处理成功的结果，并推荐使用 <code>.catch()</code> 来捕获潜在的错误。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evales">EvalES<a href="#evales" class="hash-link" aria-label="EvalES的直接链接" title="EvalES的直接链接">​</a></h2>
<p>如果你有标准 CEP 开发经验，那么对 <code>evalScript()</code> 方法一定不陌生。该方法允许在 CEP 端执行任意 ExtendScript 代码字符串。</p>
<p><code>EvalES</code> 在功能上与原生的 <code>evalScript()</code> 类似，但它是 <code>bolt-cep</code> 针对其工作流特别封装和优化过的版本。</p>
<p>我们来看看 <code>EvalES</code> 的方法签名和核心实现：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> evalES </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isGlobal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name builtin">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resolve</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pre </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> isGlobal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">var host = typeof $ !== &#x27;undefined&#x27; ? $ : window; host[&quot;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">ns</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&quot;].</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> fullString </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pre </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> script</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    csi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">evalScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;try{&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> fullString </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}catch(e){alert(e);}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>EvalES</code> 接收两个参数：</p>
<ul>
<li><code>script</code> (<code>string</code>): 需要在 Host 端执行的 ExtendScript 代码字符串。</li>
<li><code>isGlobal</code> (<code>boolean</code>, 可选, 默认为 <code>false</code>): 指示脚本是否在全局作用域中执行。若为 <code>false</code>，脚本通常会在一个特定的命名空间下执行，以避免污染全局环境。</li>
</ul>
<p><code>EvalES</code> 的返回值同样是一个 <code>Promise</code>，它会在脚本执行完毕后 resolve 并返回执行结果（通常是脚本最后一条语句的返回值，或通过特定方式返回的值，以字符串形式）。</p>
<p><code>EvalES</code> 的实现原理是对 <code>CSInterface</code> 的 <code>evalScript()</code> 方法进行了包装。在执行脚本前，它会根据 <code>isGlobal</code> 参数决定是否添加命名空间前缀，并且自动为脚本包裹了 <code>try-catch</code> 块，以便更好地捕获和处理 Host 端脚本执行时发生的错误。</p>
<p>从根本上说，<code>EvalES</code> 和 <code>EvalTS</code> 的目标相似：都是在 CEP 端触发 Host 端代码的执行。由于 <code>EvalTS</code> 调用的 TypeScript 函数最终也会被编译成 ExtendScript，因此 <code>EvalES</code> 理论上也能调用这些编译后的函数。</p>
<p>然而，两者各有侧重：</p>
<ul>
<li><strong><code>EvalTS</code></strong>：专为调用 TypeScript 函数设计，通过泛型和 <code>Scripts</code> 接口提供了类型安全和更好的开发体验（如编辑器自动补全、编译时检查）。它不能直接执行任意的 ExtendScript 代码片段。</li>
<li><strong><code>EvalES</code></strong>：更加灵活，允许执行任意的 ExtendScript 代码字符串。这在需要动态构造脚本或调用未在 <code>Scripts</code> 接口中定义的底层 ExtendScript 功能时非常有用。</li>
</ul>
<p><code>EvalTS</code> 的类型约束 <code>Key extends string &amp; keyof Scripts, Func extends Function &amp; Scripts[Key]</code> 是其核心优势，它极大地提升了调用 Host 端函数的便捷性和可靠性。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hello-world">Hello World！<a href="#hello-world" class="hash-link" aria-label="Hello World！的直接链接" title="Hello World！的直接链接">​</a></h2>
<p>以下是一个简单的示例，展示了如何在 CEP 端调用来自 Host 端的函数：</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Host 端，src/jsx/aeft/aeft.ts</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">helloWorld</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello from After Effects!&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">CEP 端，src/js/main/main.vue</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script setup lang</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> evalTS </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../lib/utils/bolt&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">helloWorldTS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">evalTS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;helloWorld&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;Hello from After Effects!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">helloWorldES</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">evalES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;helloWorld&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;Hello from After Effects!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">template</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">click</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;helloWorldTS&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">Click me</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">click</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;helloWorldES&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">Eval </span><span class="token constant" style="color:#36acaa">ES</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">template</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这是一个非常简单的示例，但是它展示了 EvalTS 以及 EvalES 的基本用法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="编码约定">编码约定<a href="#编码约定" class="hash-link" aria-label="编码约定的直接链接" title="编码约定的直接链接">​</a></h2>
<p>请阅 <a href="/springlight-traces/ext_bolt-cep-donts">别再“無路矢”！—— 部分编码约定</a>。</p>
<p>编码约定是指在开发过程中，我们需要遵守的一些规范或规则，以确保代码的可维护性、可读性和可扩展性。同时，也可以防止你踩坑（此章一开始就叫<code>部分避坑指南</code>）。</p>
<p>请一定要看！（来自写者的建议）</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="更好的调试">更好的调试<a href="#更好的调试" class="hash-link" aria-label="更好的调试的直接链接" title="更好的调试的直接链接">​</a></h2>
<p>从 <code>bolt-cep</code> 1.3.1 版本开始，<code>evalTS().catch()</code> 允许你捕获一个包含详细信息的错误对象：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;end&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;fileName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;E:\\springlight-traces\\dist\\cep\\jsx\\index.js&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;line&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">331</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;throw a error :)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Error&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;source&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(function (thisObj) {↵// ----- EXTENDSCRIPT INCLUD……&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// index.js 内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;end&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以结合其中的 <code>line</code> 和 <code>fileName</code> 信息，直接定位到编译后的 <code>index.js</code> 文件中出错的具体位置，然后再返回 TypeScript 源码进行修复。不过，这一切的前提是，你没有在 <code>cep.config.ts</code> 文件中将 <code>jsxbin</code> 设置为 <code>replace</code>。该设置会使用混淆后的 <code>jsxbin</code> 格式替换 <code>index.js</code> 文件，导致无法进行文件定位。</p>
<p>此外，<code>bolt-cep</code> 在 <code>cep.config.ts</code> 中默认将 <code>build</code> 中的 <code>sourceMap</code> 设置为 <code>true</code>，用于生成 <code>index.js.map</code> 文件。通过各类 Source Map 解析工具，你可以利用此文件，将 <code>index.js</code> 中的某一行代码精确映射回它在 TypeScript 源代码中的原始位置。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p><code>EvalTS</code> 和 <code>EvalES</code> 是 <code>bolt-cep</code> 框架中用于实现 CEP 端与 Host 端通信的核心 API。</p>
<ul>
<li><strong><code>EvalTS</code></strong> 提供了类型安全、易于使用的方式来调用在 Host 端用 TypeScript 定义的函数，是日常开发中的首选。</li>
<li><strong><code>EvalES</code></strong> 提供了更底层的灵活性，允许直接执行 ExtendScript 代码字符串，适用于特定场景。</li>
</ul>
<p>在实际开发中，我们应优先选择 <code>EvalTS</code>，因为它提供了更高的可靠性和可维护性。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/springlight-traces/getting-started-with-project-files"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">熟悉 bolt-cep 项目结构</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/springlight-traces/listen-ts-and-dispatch-ts"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">ListenTS 和 DispatchTS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#evalts-与-evales-是什么" class="table-of-contents__link toc-highlight">EvalTS 与 EvalES 是什么？</a></li><li><a href="#evalts" class="table-of-contents__link toc-highlight">EvalTS</a></li><li><a href="#evales" class="table-of-contents__link toc-highlight">EvalES</a></li><li><a href="#hello-world" class="table-of-contents__link toc-highlight">Hello World！</a></li><li><a href="#编码约定" class="table-of-contents__link toc-highlight">编码约定</a></li><li><a href="#更好的调试" class="table-of-contents__link toc-highlight">更好的调试</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 春日影踪编写组, 基于 Docusaurus.</div></div></div></footer></div>
</body>
</html>